import{r as o,j as e,y as v,T as h}from"./app-Cog3cE_0.js";import{f as _}from"./date-DbclOb_I.js";import{m as b,a as O,b as C}from"./chunk-3BLMMOBU-DpVJ-GvV.js";import{b as m}from"./useDialog-C-XOVp3m.js";function D(){const[f,s]=o.useState(!1),[t,g]=o.useState(null),[c]=o.useState(5);o.useEffect(()=>{const a=async()=>{try{const r=(await axios.get("/overdue-guests",{params:{threshold:60}})).data;if(console.log(r),r.length>0){const n=r.reduce((d,u)=>new Date(d.check_in_time)<new Date(u.check_in_time)?d:u),i=new Date(n.check_in_time),k=Math.floor((Date.now()-i.getTime())/(60*60*1e3));g({guest:n.guest.name,checkInTime:i,hoursOverdue:k,logId:n.id}),s(!0)}else s(!1)}catch(l){console.error("Failed to fetch overdue guests:",l)}};a();const j=setInterval(a,c*60*1e3);return()=>clearInterval(j)},[c]);const p=()=>{s(!1),setTimeout(()=>s(!0),10*60*1e3)},x=()=>{t!=null&&t.logId&&v.post(route("guest.log.checkout",t.logId),{},{onSuccess:()=>{h({title:"Guest Checked Out",description:`${t.guest} has been successfully checked out.`,color:success}),s(!1)},onError:()=>{h({title:"Checkout Failed",description:"An error occurred while checking out the guest.",color:danger})}})};return e.jsx(b,{isOpen:f,onClose:()=>s(!1),placement:"center",backdrop:"blur",children:e.jsx(O,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Overdue Check-out Reminder"}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-4",children:[e.jsx("strong",{children:t.guest})," has not checked out after"," ",e.jsxs("strong",{children:[t.hoursOverdue," hour(s)"]}),"."]}),e.jsxs("p",{children:["Checked in at:"," ",_(t.checkInTime)]})]}),e.jsxs("div",{className:"mt-6 flex justify-center gap-3",children:[e.jsx(m,{color:"primary",onPress:x,children:"Check Out Now"}),e.jsx(m,{variant:"flat",onPress:p,children:"Remind Me Later"})]})]})})})})}export{D as A};
