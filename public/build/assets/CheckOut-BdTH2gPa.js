import{r as a,a6 as C,j as e,Y as z,a as b,a7 as G}from"./app-BgPJxW1M.js";import{S as _}from"./sweetalert2.all-DRkH_Ac5.js";import{S as M}from"./Icons-BMDUzsRI.js";import{A}from"./AlertReminderModal-OILN-OYi.js";import{f as y}from"./date-DbclOb_I.js";import{G as R}from"./iconBase-C5oiep6w.js";import{c as B}from"./chunk-MW56SEHC-C1tH-uNZ.js";import{b as j}from"./useDialog-BAG7Eb_K.js";import{i as F}from"./chunk-6MDMHKHV-Dmc0XIQK.js";import{t as V,a as L,b as o,c as W,d as Y,e as d}from"./chunk-F3UDT23P-D-N1hNii.js";import{e as k,d as n}from"./chunk-2GIFKCNQ-D0bu-Iml.js";import{p as q}from"./chunk-O5I3QTYU-Dr-MrWIT.js";import"./chunk-3BLMMOBU-CoJT5qRx.js";import"./index-C9HaU8Wt.js";import"./chunk-SLABUSGS-UT7_g1Pg.js";import"./useMenuTriggerState-C2ONs9Sh.js";import"./index-BXYXcNLJ.js";import"./chunk-2PG5BJX6-BBjaD8Z_.js";import"./index-X92CTFGl.js";const J=(r=6e4)=>{const l=a.useRef(null);a.useEffect(()=>{const m=()=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{C.visit("/",{replace:!0})},r)};m();const i=()=>{m()};return window.addEventListener("mousemove",i),window.addEventListener("keydown",i),()=>{l.current&&clearTimeout(l.current),window.removeEventListener("mousemove",i),window.removeEventListener("keydown",i)}},[r])};function K(r){return R({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 13h1v7c0 1.103.897 2 2 2h12c1.103 0 2-.897 2-2v-7h1a1 1 0 0 0 .707-1.707l-9-9a.999.999 0 0 0-1.414 0l-9 9A1 1 0 0 0 3 13zm9-8.586 6 6V15l.001 5H6v-9.586l6-6z"},child:[]},{tag:"path",attr:{d:"M12 18c3.703 0 4.901-3.539 4.95-3.689l-1.9-.621c-.008.023-.781 2.31-3.05 2.31-2.238 0-3.02-2.221-3.051-2.316l-1.899.627C7.099 14.461 8.297 18 12 18z"},child:[]}]})(r)}function xe({guestLogs:r}){const[l,m]=a.useState(""),[i,v]=a.useState(1),[u,N]=a.useState(13),[x,D]=a.useState("past24Hours"),[S,w]=a.useState([]),[g,f]=a.useState(null);J(),a.useEffect(()=>{(()=>{const s=new Date;let c=null;switch(x){case"past24Hours":c=new Date(s.getTime()-864e5);break;case"past7Days":c=new Date(s.getTime()-6048e5);break;case"past30Days":c=new Date(s.getTime()-2592e6);break;default:c=null;break}if(c){const H=r.filter(O=>new Date(O.check_in_time)>=c);w(H)}else w(r)})()},[x,r]);const h=S.filter(t=>t.guest.name.toLowerCase().includes(l.toLowerCase())),p=i*u,P=p-u,I=h.slice(P,p),T=t=>v(t),E=async t=>{f(t);try{C.post(route("guest.checkout",t),{},{onSuccess:s=>{G({title:"Success",description:s.props.flash.success,color:"success"})},onError:s=>{_.fire({title:"Error!",text:s.message,icon:"error"})},onFinish:()=>{f(null)}})}catch{_.fire({title:"Connection Error",text:"Please check your network and try again",icon:"error"}),f(null)}};return e.jsxs("div",{className:"min-h-screen bg-[url(/assets/images/bg.png)] bg-cover",children:[e.jsx(z,{title:"Check Out"}),e.jsx("div",{className:"py-12 p-4",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(B,{className:"w-full p-4 bg-gray-100",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 ",children:e.jsxs("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary relative",children:["Guest Check-out",e.jsx("span",{className:"absolute  left-1/2 transform -translate-x-1/2 -bottom-2 h-[3px] w-16 bg-[#2aefe6]"})]})}),e.jsx("p",{className:"text-sm font-light",children:"Manage guest check-outs from this panel"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between gap-3 items-end mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{as:b,href:route("guest.checkin.create"),color:"primary",variant:"shadow",children:"Check-in"}),e.jsx(j,{as:b,href:"/",color:"primary",variant:"flat",isIconOnly:!0,children:e.jsx(K,{size:24})})]}),e.jsx(F,{variant:"bordered",placeholder:"Search",className:"w-full sm:max-w-[35%]",startContent:e.jsx(M,{className:"text-black/50 mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"}),value:l,onChange:t=>{m(t.target.value),v(1)}})]}),e.jsxs(V,{"aria-label":"Guests Table",topContent:e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2 w-[35%]",children:[e.jsxs(k,{size:"sm",variant:"faded",placeholder:"Items Per Page",value:u.toString(),onChange:t=>N(Number(t.target.value)),"aria-label":"Items per page",children:[e.jsx(n,{value:"5",children:"5"},"5"),e.jsx(n,{value:"10",children:"10"},"10"),e.jsx(n,{value:"15",children:"15"},"15")]}),e.jsxs(k,{size:"sm",variant:"faded",placeholder:"Past 24 Hours",value:x,onChange:t=>D(t.target.value),"aria-label":"Time interval filter",children:[e.jsx(n,{value:"current",children:"All Time"},"current"),e.jsx(n,{value:"past24Hours",children:"Past 24 Hours"},"past24Hours"),e.jsx(n,{value:"past7Days",children:"Past 7 Days"},"past7Days"),e.jsx(n,{value:"past30Days",children:"Past 30 Days"},"past30Days")]})]}),e.jsxs("p",{className:"text-sm italic text-default-500",children:["Showing"," ",Math.min(p,h.length)," ","of ",h.length," ","records"]})]}),children:[e.jsxs(L,{children:[e.jsx(o,{children:"Guest ID"}),e.jsx(o,{children:"Guest Name"}),e.jsx(o,{children:"Meeting With"}),e.jsx(o,{children:"Purpose of Visit"}),e.jsx(o,{children:"Check In"}),e.jsx(o,{children:"Check Out"})]}),e.jsx(W,{emptyContent:"No log for today.",children:I.sort((t,s)=>new Date(s.created_at)-new Date(t.created_at)).map(t=>e.jsxs(Y,{children:[e.jsx(d,{children:t.guest_id}),e.jsx(d,{children:t.guest.name}),e.jsx(d,{children:t.meeting_with||"--"}),e.jsx(d,{children:t.purpose_of_visit}),e.jsx(d,{children:y(t.check_in_time)}),e.jsx(d,{children:t.check_out_time?y(t.check_out_time):e.jsx(j,{onPress:()=>E(t.id),color:"success",size:"sm",isLoading:g===t.id,children:g===t.id?"Please wait...":"Check-Out"})})]},t.id))})]}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(q,{color:"primary",showShadow:!0,isCompact:!0,showControls:!0,total:Math.ceil(h.length/u),page:i,onChange:T})})]})]})})}),e.jsx(A,{})]})}export{xe as default};
