import{r as s,j as e,Y as M,a as b,y as O}from"./app-DrNWwami.js";import{S as x}from"./sweetalert2.all-v7t1F3Wn.js";import{S as z}from"./Icons-CfEnB7jo.js";import{A as E}from"./AlertReminderModal-f69f0Wj2.js";import{u as F,d as T,f as _,e as a}from"./useflashMessages-DofE57w6.js";import{f as w}from"./date-DbclOb_I.js";import{G as A}from"./iconBase-drxDCob1.js";import{t as B,a as V,b as i,c as R,d as W,e as n}from"./chunk-F3UDT23P-J0o8n-Lq.js";import{p as Y}from"./chunk-O5I3QTYU-7dC2ieHk.js";import{c as $}from"./chunk-MW56SEHC-C6LTbjSg.js";import{b as f}from"./useDialog-Di36_uni.js";import{i as q}from"./chunk-6MDMHKHV-DmO_v9hH.js";import"./chunk-3BLMMOBU-D-PHTKql.js";import"./index-Du4sZGOB.js";import"./useMenuTriggerState-C7FIa5eO.js";import"./chunk-SLABUSGS-CD9Ro_xR.js";import"./index-BgjJgvBe.js";import"./chunk-2PG5BJX6-CelJ0w7I.js";import"./chunk-MZRCPRP2-DT8drFo4.js";import"./chunk-LGMZDQT5-DN_zI6e3.js";import"./LiveAnnouncer-6wq0YUFY.js";import"./index-X92CTFGl.js";function J(c){return A({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 13h1v7c0 1.103.897 2 2 2h12c1.103 0 2-.897 2-2v-7h1a1 1 0 0 0 .707-1.707l-9-9a.999.999 0 0 0-1.414 0l-9 9A1 1 0 0 0 3 13zm9-8.586 6 6V15l.001 5H6v-9.586l6-6z"},child:[]},{tag:"path",attr:{d:"M12 18c3.703 0 4.901-3.539 4.95-3.689l-1.9-.621c-.008.023-.781 2.31-3.05 2.31-2.238 0-3.02-2.221-3.051-2.316l-1.899.627C7.099 14.461 8.297 18 12 18z"},child:[]}]})(c)}function je({guestLogs:c}){const[p,y]=s.useState(""),[j,g]=s.useState(1),[o,k]=s.useState(13),[m,C]=s.useState("past24Hours"),[N,v]=s.useState([]),[K,h]=s.useState(null);F(),T(),s.useEffect(()=>{(()=>{const r=new Date;let l=null;switch(m){case"past24Hours":l=new Date(r.getTime()-864e5);break;case"past7Days":l=new Date(r.getTime()-6048e5);break;case"past30Days":l=new Date(r.getTime()-2592e6);break;default:l=null;break}if(l){const G=c.filter(H=>new Date(H.check_in_time)>=l);v(G)}else v(c)})()},[m,c]);const d=N.filter(t=>t.guest.name.toLowerCase().includes(p.toLowerCase())),u=j*o,D=u-o,S=d.slice(D,u),P=t=>g(t),I=async t=>{h(t);try{O.post(`/guest/log/check-out/${t}`,{},{onSuccess:()=>{x.fire({title:"Success!",text:"Guest checked out successfully",icon:"success",timer:2e3,showConfirmButton:!1})},onError:()=>{x.fire({title:"Error!",text:"Failed to check out guest",icon:"error"})},onFinish:()=>{h(null)}})}catch{x.fire({title:"Connection Error",text:"Please check your network and try again",icon:"error"}),h(null)}};return e.jsxs("div",{className:"min-h-screen bg-[url(/assets/images/bg.png)] bg-cover",children:[e.jsx(M,{title:"Check Out"}),e.jsx("div",{className:"py-12 p-4",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full p-4 bg-gray-100",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 ",children:e.jsxs("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary relative",children:["Guest Check-out",e.jsx("span",{className:"absolute  left-1/2 transform -translate-x-1/2 -bottom-2 h-[3px] w-16 bg-[#2aefe6]"})]})}),e.jsx("p",{className:"text-sm font-light",children:"Manage guest check-outs from this panel"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between gap-3 items-end mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{as:b,href:route("guestlog.create"),color:"primary",variant:"shadow",children:"Check-in"}),e.jsx(f,{as:b,href:"/",color:"primary",variant:"flat",isIconOnly:!0,children:e.jsx(J,{size:24})})]}),e.jsx(q,{variant:"bordered",placeholder:"Search",className:"w-full sm:max-w-[35%]",startContent:e.jsx(z,{className:"text-black/50 mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"}),value:p,onChange:t=>{y(t.target.value),g(1)}})]}),e.jsxs(B,{"aria-label":"Guests Table",topContent:e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2 w-[35%]",children:[e.jsxs(_,{size:"sm",variant:"faded",placeholder:"Items Per Page",value:o.toString(),onChange:t=>k(Number(t.target.value)),children:[e.jsx(a,{value:"5",children:"5"},"5"),e.jsx(a,{value:"10",children:"10"},"10"),e.jsx(a,{value:"15",children:"15"},"15")]}),e.jsxs(_,{size:"sm",variant:"faded",placeholder:"Past 24 Hours",value:m,onChange:t=>C(t.target.value),children:[e.jsx(a,{value:"current",children:"All Time"},"current"),e.jsx(a,{value:"past24Hours",children:"Past 24 Hours"},"past24Hours"),e.jsx(a,{value:"past7Days",children:"Past 7 Days"},"past7Days"),e.jsx(a,{value:"past30Days",children:"Past 30 Days"},"past30Days")]})]}),e.jsxs("p",{className:"text-sm italic text-default-500",children:["Showing"," ",Math.min(u,d.length)," ","of ",d.length," ","records"]})]}),children:[e.jsxs(V,{children:[e.jsx(i,{children:"Guest ID"}),e.jsx(i,{children:"Guest Name"}),e.jsx(i,{children:"Meeting With"}),e.jsx(i,{children:"Purpose of Visit"}),e.jsx(i,{children:"Check In"}),e.jsx(i,{children:"Check Out"})]}),e.jsx(R,{emptyContent:"No log for today.",children:S.sort((t,r)=>new Date(r.created_at)-new Date(t.created_at)).map(t=>e.jsxs(W,{children:[e.jsx(n,{children:t.guest_id}),e.jsx(n,{children:t.guest.name}),e.jsx(n,{children:t.meeting_with||"--"}),e.jsx(n,{children:t.purpose_of_visit}),e.jsx(n,{children:w(t.check_in_time)}),e.jsx(n,{children:t.check_out_time?w(t.check_out_time):e.jsx(f,{onPress:()=>I(t.id),color:"success",size:"sm",children:"Check Out"})})]},t.id))})]}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Y,{color:"primary",showShadow:!0,isCompact:!0,showControls:!0,total:Math.ceil(d.length/o),page:j,onChange:P})})]})]})})}),e.jsx(E,{})]})}export{je as default};
