import{r as n,F as D,X as E,W as y,j as e,Y as I}from"./app-DkBnPLOY.js";import{A as N}from"./AuthenticatedLayout-CIBhvKjM.js";import{D as S}from"./Icons-BeWmp4Ku.js";import{S as h}from"./sweetalert2.all-mneknCZG.js";import{$ as U}from"./index-Ck-A_1Nn.js";import{u as v}from"./index-DP3AbKl-.js";import{m as $,a as k,b as R}from"./chunk-3BLMMOBU-DEJrIjf5.js";import{m as A,a as F}from"./chunk-IGSAU2ZA-Br-TAT_7.js";import{b as j}from"./useDialog-C18L4xOP.js";import{t as B,a as M,b as f,c as W,d as Y,e as m}from"./chunk-F3UDT23P-ShlPy2B2.js";import{t as z}from"./chunk-7ZZXWEXF-DC6nu6z1.js";import{i as T}from"./chunk-6MDMHKHV-pyKp5-lY.js";import"./ApplicationLogo-C6ybhx-t.js";import"./useMenuTriggerState-VKY5J75s.js";import"./chunk-A6PX3NG3-CEDMUpjQ.js";import"./index-Xrjn7JOd.js";function K(b={}){const{id:_,defaultOpen:C,isOpen:r,onClose:P,onOpen:g,onChange:O=()=>{}}=b,i=v(g),d=v(P),[t,c]=U(r,C||!1,O),u=n.useId(),x=_||u,a=r!==void 0,p=n.useCallback(()=>{a||c(!1),d==null||d()},[a,d]),s=n.useCallback(()=>{a||c(!0),i==null||i()},[a,i]),l=n.useCallback(()=>{(t?p:s)()},[t,s,p]);return{isOpen:!!t,onOpen:s,onClose:p,onOpenChange:l,isControlled:a,getButtonProps:(o={})=>({...o,"aria-expanded":t,"aria-controls":x,onClick:D(o.onClick,l)}),getDisclosureProps:(o={})=>({...o,hidden:!t,id:x})}}function ne({auth:b}){const{isOpen:_,onOpen:C,onClose:r}=K(),{data:P,setData:g,post:O,processing:i,reset:d}=E({file:null}),[t,c]=n.useState([]);n.useEffect(()=>{u()},[]);const u=async()=>{const s=await y.get("/media/all");c(s.data)},x=s=>{s.preventDefault(),O(route("media.upload"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{h.fire("Success","Media uploaded!","success"),u(),d(),r()},onError:()=>{h.fire("Error","Upload failed!","error")}})},a=async s=>{(await h.fire({title:"Delete media?",icon:"warning",showCancelButton:!0})).isConfirmed&&(await y.delete(`/media/${s}`),c(o=>o.filter(w=>w.id!==s)),h.fire("Deleted!","","success"))},p=s=>{const l=`/storage/${s.file_path}`;return s.file_type.includes("image")?e.jsx("img",{src:l,className:"h-16 rounded shadow"}):s.file_type.includes("video")?e.jsx("video",{src:l,className:"h-16",controls:!0,preload:"metadata",children:"Your browser does not support video."}):"Unsupported file"};return e.jsxs(N,{user:b.user,header:e.jsx("h2",{className:"font-semibold text-xl",children:"Upload Media"}),children:[e.jsx(I,{title:"Upload Media"}),e.jsxs("div",{className:"py-8 px-4 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex mb-4",children:e.jsx(j,{color:"primary",onPress:C,children:"Add"})}),e.jsxs(B,{"aria-label":"Uploaded media",children:[e.jsxs(M,{children:[e.jsx(f,{children:"File Path"}),e.jsx(f,{children:"PREVIEW"}),e.jsx(f,{children:"TYPE"}),e.jsx(f,{children:"SIZE (KB)"}),e.jsx(f,{children:"ACTION"})]}),e.jsx(W,{emptyContent:"No media uploaded.",children:t.map(s=>e.jsxs(Y,{children:[e.jsx(m,{className:"italic",children:s.file_path}),e.jsx(m,{children:p(s)}),e.jsx(m,{children:s.file_type}),e.jsx(m,{children:s.file_size}),e.jsx(m,{children:e.jsx(z,{content:"Delete",children:e.jsx(j,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>a(s.id),children:e.jsx(S,{className:"text-lg text-danger"})})})})]},s.id))})]}),e.jsx($,{isOpen:_,onClose:r,children:e.jsx(k,{children:e.jsxs("form",{onSubmit:x,children:[e.jsx(A,{children:"Upload File"}),e.jsx(R,{children:e.jsx(T,{type:"file",accept:".jpg,.jpeg,.png,.webp,.mp4",onChange:s=>g("file",s.target.files[0])})}),e.jsxs(F,{children:[e.jsx(j,{type:"submit",color:"primary",isLoading:i,children:"Upload"}),e.jsx(j,{color:"danger",onPress:r,children:"Cancel"})]})]})})})]})]})}export{ne as default};
