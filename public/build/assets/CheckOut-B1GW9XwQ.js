import{r as a,y as C,j as e,Y as A,a as g,ac as G}from"./app-BtwzIHbo.js";import{S as _}from"./sweetalert2.all-COT6VUhA.js";import{S as M}from"./Icons-KRdaNT8p.js";import{A as R}from"./AlertReminderModal-C3Bz7UQA.js";import{f as y}from"./date-DbclOb_I.js";import{b as z}from"./index-DppVieI4.js";import{c as B}from"./chunk-MW56SEHC-Mg-dD-sa.js";import{b as j}from"./chunk-GT2IF6NJ-CohJijkR.js";import{i as F}from"./chunk-6MDMHKHV-C9ZlYfVk.js";import{t as V,a as L,b as o,c as U,d as W,e as d}from"./chunk-F3UDT23P-B8JgCAfW.js";import{e as k,d as i}from"./chunk-2GIFKCNQ-BY2QIgoQ.js";import{p as Y}from"./chunk-O5I3QTYU-CFBfpP65.js";import"./index-CDt-zDqJ.js";import"./useMenuTriggerState-C8vs6hYr.js";import"./index-BDQ88KpA.js";import"./chunk-2PG5BJX6-D58lRpi1.js";const q=(n=6e4)=>{const r=a.useRef(null);a.useEffect(()=>{const m=()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{C.visit("/",{replace:!0})},n)};m();const l=()=>{m()};return window.addEventListener("mousemove",l),window.addEventListener("keydown",l),()=>{r.current&&clearTimeout(r.current),window.removeEventListener("mousemove",l),window.removeEventListener("keydown",l)}},[n])};function de({guestLogs:n}){const[r,m]=a.useState(""),[l,v]=a.useState(1),[u,N]=a.useState(13),[f,D]=a.useState("past24Hours"),[P,w]=a.useState([]),[b,x]=a.useState(null);q(),a.useEffect(()=>{(()=>{const s=new Date;let c=null;switch(f){case"past24Hours":c=new Date(s.getTime()-864e5);break;case"past7Days":c=new Date(s.getTime()-6048e5);break;case"past30Days":c=new Date(s.getTime()-2592e6);break;default:c=null;break}if(c){const O=n.filter(H=>new Date(H.check_in_time)>=c);w(O)}else w(n)})()},[f,n]);const h=P.filter(t=>t.guest.name.toLowerCase().includes(r.toLowerCase())),p=l*u,S=p-u,I=h.slice(S,p),T=t=>v(t),E=async t=>{x(t);try{C.post(route("guest.checkout",t),{},{onSuccess:s=>{G({title:"Success",description:s.props.flash.success,color:"success"})},onError:s=>{_.fire({title:"Error!",text:s.message,icon:"error"})},onFinish:()=>{x(null)}})}catch{_.fire({title:"Connection Error",text:"Please check your network and try again",icon:"error"}),x(null)}};return e.jsxs("div",{className:"min-h-screen bg-[url(/assets/images/bg.png)] bg-cover",children:[e.jsx(A,{title:"Check-Out"}),e.jsx("div",{className:"py-12 p-4",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(B,{className:"w-full p-4 bg-gray-100",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 ",children:e.jsxs("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary to-secondary relative",children:["Guest Check-out",e.jsx("span",{className:"absolute  left-1/2 transform -translate-x-1/2 -bottom-2 h-[3px] w-16 bg-[#2aefe6]"})]})}),e.jsx("p",{className:"text-sm font-light",children:"Manage guest check-outs from this panel"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between gap-3 items-end mb-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx(j,{as:g,href:"/",color:"default",variant:"light",startContent:e.jsx(z,{size:32}),children:"Back"}),e.jsx(j,{as:g,href:route("guest.checkin.create"),color:"primary",variant:"shadow",children:"Check-in"})]}),e.jsx(F,{placeholder:"Search",variant:"bordered",className:"w-full sm:max-w-[35%]",startContent:e.jsx(M,{}),value:r,onChange:t=>{m(t.target.value),v(1)}})]}),e.jsxs(V,{"aria-label":"Guests Table",topContent:e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2 w-[35%]",children:[e.jsxs(k,{size:"sm",variant:"faded",placeholder:"Items Per Page",value:u.toString(),onChange:t=>N(Number(t.target.value)),"aria-label":"Items per page",children:[e.jsx(i,{value:"5",children:"5"},"5"),e.jsx(i,{value:"10",children:"10"},"10"),e.jsx(i,{value:"15",children:"15"},"15")]}),e.jsxs(k,{size:"sm",variant:"faded",placeholder:"Past 24 Hours",value:f,onChange:t=>D(t.target.value),"aria-label":"Time interval filter",children:[e.jsx(i,{value:"current",children:"All Time"},"current"),e.jsx(i,{value:"past24Hours",children:"Past 24 Hours"},"past24Hours"),e.jsx(i,{value:"past7Days",children:"Past 7 Days"},"past7Days"),e.jsx(i,{value:"past30Days",children:"Past 30 Days"},"past30Days")]})]}),e.jsxs("p",{className:"text-sm italic text-default-500",children:["Showing"," ",Math.min(p,h.length)," ","of ",h.length," ","records"]})]}),children:[e.jsxs(L,{children:[e.jsx(o,{children:"Guest ID"}),e.jsx(o,{children:"Guest Name"}),e.jsx(o,{children:"Meeting With"}),e.jsx(o,{children:"Purpose of Visit"}),e.jsx(o,{children:"Check In"}),e.jsx(o,{children:"Check Out"})]}),e.jsx(U,{emptyContent:"No log for today.",children:I.sort((t,s)=>new Date(s.created_at)-new Date(t.created_at)).map(t=>e.jsxs(W,{children:[e.jsx(d,{children:t.guest_id}),e.jsx(d,{children:t.guest.name}),e.jsx(d,{children:t.meeting_with||"--"}),e.jsx(d,{children:t.purpose_of_visit}),e.jsx(d,{children:y(t.check_in_time)}),e.jsx(d,{children:t.check_out_time?y(t.check_out_time):e.jsx(j,{onPress:()=>E(t.id),color:"success",size:"sm",isLoading:b===t.id,children:b===t.id?"Please wait...":"Check-Out"})})]},t.id))})]}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Y,{color:"primary",showShadow:!0,isCompact:!0,showControls:!0,total:Math.ceil(h.length/u),page:l,onChange:T})})]})]})})}),e.jsx(R,{})]})}export{de as default};
