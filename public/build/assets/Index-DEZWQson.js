import{r as n,Q as D,a3 as E,a2 as y,j as e,Y as S}from"./app-BKtn4RYs.js";import{A as U}from"./AuthenticatedLayout-BGzReuXe.js";import{S as u}from"./sweetalert2.all-C4lJnEGT.js";import{$}from"./index-BP-ejmFy.js";import{u as w}from"./index-9hbZf2vQ.js";import{m as k,a as I,b as N}from"./chunk-3BLMMOBU-DGyQcWT0.js";import{m as R,a as A}from"./chunk-IGSAU2ZA-Bih1ps7e.js";import{b as x}from"./useDialog-aHJarbcU.js";import{t as M,a as B,b as h,c as Y,d as z,e as j}from"./chunk-F3UDT23P-C0rARL7u.js";import{i as F}from"./chunk-6MDMHKHV-DZh9xQkN.js";import"./ApplicationLogo-C_7KyiTT.js";import"./useMenuTriggerState-DJVmRDPA.js";import"./chunk-A6PX3NG3-DLN5o8h0.js";import"./index-FMckFMUw.js";import"./LiveAnnouncer-CPf1B4B4.js";function T(b={}){const{id:_,defaultOpen:C,isOpen:r,onClose:P,onOpen:g,onChange:O=()=>{}}=b,i=w(g),d=w(P),[o,c]=$(r,C||!1,O),f=n.useId(),m=_||f,a=r!==void 0,p=n.useCallback(()=>{a||c(!1),d==null||d()},[a,d]),s=n.useCallback(()=>{a||c(!0),i==null||i()},[a,i]),l=n.useCallback(()=>{(o?p:s)()},[o,s,p]);return{isOpen:!!o,onOpen:s,onClose:p,onOpenChange:l,isControlled:a,getButtonProps:(t={})=>({...t,"aria-expanded":o,"aria-controls":m,onClick:D(t.onClick,l)}),getDisclosureProps:(t={})=>({...t,hidden:!o,id:m})}}function te({auth:b}){const{isOpen:_,onOpen:C,onClose:r}=T(),{data:P,setData:g,post:O,processing:i,reset:d}=E({file:null}),[o,c]=n.useState([]);n.useEffect(()=>{f()},[]);const f=async()=>{const s=await y.get("/media/all");c(s.data)},m=s=>{s.preventDefault(),O(route("media.upload"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{u.fire("Success","Media uploaded!","success"),f(),d(),r()},onError:()=>{u.fire("Error","Upload failed!","error")}})},a=async s=>{(await u.fire({title:"Delete media?",icon:"warning",showCancelButton:!0})).isConfirmed&&(await y.delete(`/media/${s}`),c(t=>t.filter(v=>v.id!==s)),u.fire("Deleted!","","success"))},p=s=>{const l=`/storage/${s.file_path}`;return s.file_type.includes("image")?e.jsx("img",{src:l,className:"h-16 rounded shadow"}):s.file_type.includes("video")?e.jsx("video",{src:l,className:"h-16",controls:!0,preload:"metadata",children:"Your browser does not support video."}):"Unsupported file"};return e.jsxs(U,{user:b.user,header:e.jsx("h2",{className:"font-semibold text-xl",children:"Upload Media"}),children:[e.jsx(S,{title:"Upload Media"}),e.jsxs("div",{className:"py-8 px-4 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex mb-4",children:e.jsx(x,{color:"primary",onPress:C,children:"Add Media"})}),e.jsxs(M,{"aria-label":"Uploaded media",children:[e.jsxs(B,{children:[e.jsx(h,{children:"PREVIEW"}),e.jsx(h,{children:"TYPE"}),e.jsx(h,{children:"SIZE (KB)"}),e.jsx(h,{children:"ACTION"})]}),e.jsx(Y,{emptyContent:"No media uploaded.",children:o.map(s=>e.jsxs(z,{children:[e.jsx(j,{children:p(s)}),e.jsx(j,{children:s.file_type}),e.jsx(j,{children:s.file_size}),e.jsx(j,{children:e.jsx(x,{color:"danger",size:"sm",onPress:()=>a(s.id),children:"Delete"})})]},s.id))})]}),e.jsx(k,{isOpen:_,onClose:r,children:e.jsx(I,{children:e.jsxs("form",{onSubmit:m,children:[e.jsx(R,{children:"Upload File"}),e.jsx(N,{children:e.jsx(F,{type:"file",accept:".jpg,.jpeg,.png,.webp,.mp4",onChange:s=>g("file",s.target.files[0])})}),e.jsxs(A,{children:[e.jsx(x,{type:"submit",color:"primary",isLoading:i,children:"Upload"}),e.jsx(x,{color:"danger",onPress:r,children:"Cancel"})]})]})})})]})]})}export{te as default};
