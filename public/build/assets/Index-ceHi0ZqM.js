import{q as D,m as d,j as e,Y as E,b as S}from"./app-BgPJxW1M.js";import{S as F}from"./Icons-BMDUzsRI.js";import{A as G}from"./AuthenticatedLayout-4UDuBHRk.js";import{F as M}from"./index-BbBjSb_3.js";import{S as p}from"./sweetalert2.all-DRkH_Ac5.js";import{i as o}from"./chunk-6MDMHKHV-Dmc0XIQK.js";import{t as R,a as A,b as t,c as O,d as k,e as a}from"./chunk-F3UDT23P-D-N1hNii.js";import{p as I}from"./chunk-O5I3QTYU-Dr-MrWIT.js";import{b as h}from"./useDialog-BAG7Eb_K.js";import{m as L,a as T,b as B}from"./chunk-3BLMMOBU-CoJT5qRx.js";import{m as U,a as V}from"./chunk-IGSAU2ZA-UMKHaw83.js";import"./ApplicationLogo-ICvcoLbq.js";import"./useMenuTriggerState-C2ONs9Sh.js";import"./index-C9HaU8Wt.js";import"./chunk-A6PX3NG3-D0tUKdqy.js";import"./index-B8DAAwzc.js";import"./iconBase-C5oiep6w.js";import"./chunk-SLABUSGS-UT7_g1Pg.js";import"./index-BXYXcNLJ.js";import"./index-X92CTFGl.js";function ce({auth:b}){const{props:{guests:g}}=D(),[u,v]=d.useState(""),n=g.slice().sort((s,r)=>s.name.localeCompare(r.name)).filter(s=>s.name.toLowerCase().includes(u.toLowerCase())),[_,f]=d.useState(!1),[l,w]=d.useState(null),y=async()=>{if(n.length===0){p.fire({icon:"warning",title:"No Records",text:"There are no guests to export."});return}try{const s=await S.get("/generate-report",{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([s.data])),m=document.createElement("a");m.href=r,m.setAttribute("download","Guests_Report.pdf"),document.body.appendChild(m),m.click(),p.fire({icon:"success",title:"PDF Report Generated",text:"The PDF report has been successfully generated and downloaded."})}catch(s){console.error("Error generating PDF report:",s),p.fire({icon:"error",title:"Error",text:"Failed to generate PDF report. Please try again later."})}},N=s=>{w(s),f(!0)},j=()=>{f(!1)},[c,C]=d.useState(1),i=10,P=Math.ceil(n.length/i),x=d.useMemo(()=>{const s=(c-1)*i,r=s+i;return n.slice(s,r)},[c,i,n]);return e.jsxs(G,{user:b.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Registered Guests"}),children:[e.jsx(E,{title:"Registered Guests"}),e.jsx("div",{className:"py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex justify-end gap-3 items-end mb-4",children:e.jsx(o,{variant:"bordered",value:u,onChange:s=>v(s.target.value),placeholder:"Search by name",className:"w-full sm:max-w-[35%]",startContent:e.jsx(F,{className:"text-black/50 mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"})})})}),e.jsxs(R,{"aria-label":"Guests Table",bottomContent:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(I,{isCompact:!0,showControls:!0,showShadow:!0,color:"secondary",page:c,total:P,onChange:s=>C(s)})}),classNames:{wrapper:"min-h-[222px]"},topContent:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(h,{color:"primary",variant:"bordered",onPress:y,startContent:e.jsx(M,{size:20}),children:"Export to PDF"}),e.jsxs("p",{className:"text-sm italic text-gray-700",children:["showing ",x.length," of"," ",n.length," guests"]})]}),children:[e.jsxs(A,{children:[e.jsx(t,{className:"text-success",children:"#"}),e.jsx(t,{children:"NAME"}),e.jsx(t,{children:"EMAIL"}),e.jsx(t,{children:"PHONE"}),e.jsx(t,{children:"COMPANY"}),e.jsx(t,{children:"ID TYPE"}),e.jsx(t,{children:"ID NUMBER"}),e.jsx(t,{children:"ADDRESS"}),e.jsx(t,{children:"Actions"})]}),e.jsx(O,{emptyContent:"No guests found",items:x,children:x.map((s,r)=>e.jsxs(k,{children:[e.jsx(a,{className:"text-success",children:(c-1)*i+r+1}),e.jsx(a,{children:s.name}),e.jsx(a,{children:s.email||"--"}),e.jsx(a,{children:s.phone||"--"}),e.jsx(a,{children:s.company}),e.jsx(a,{children:s.id_type||"--"}),e.jsx(a,{children:s.id_number||"--"}),e.jsx(a,{children:s.address||"--"}),e.jsx(a,{children:e.jsx(h,{color:"secondary",variant:"flat",onPress:()=>N(s),children:"View"})})]},s.id))})]})]})}),e.jsx(L,{isDismissable:!1,isOpen:_,onOpenChange:j,hideCloseButton:!0,backdrop:"blur",children:e.jsx(T,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"flex flex-col gap-1",children:"Guest Details"}),e.jsx(B,{children:l&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(o,{label:"Name",variant:"bordered",value:l.name}),e.jsx(o,{label:"Email",variant:"bordered",value:l.email}),e.jsx(o,{label:"Phone",variant:"bordered",value:l.phone??void 0}),e.jsx(o,{label:"Company",variant:"bordered",value:l.company??void 0}),e.jsx(o,{label:"Address",variant:"bordered",value:l.address??void 0})]})}),e.jsx(V,{children:e.jsx(h,{color:"primary",onPress:j,children:"Close"})})]})})})]})}export{ce as default};
