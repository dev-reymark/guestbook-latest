import{r,j as e,y as v,T as h}from"./app-DGGxljuJ.js";import{f as _}from"./date-DbclOb_I.js";import{m as b,a as O,b as C}from"./chunk-3BLMMOBU-CR5Zpq7f.js";import{b as m}from"./useDialog-Dsyxr5RJ.js";function D(){const[f,s]=r.useState(!1),[t,g]=r.useState(null),[n]=r.useState(5);r.useEffect(()=>{const c=async()=>{try{const l=(await axios.get("/overdue-guests",{params:{threshold:30}})).data;if(l.length>0){const o=l.reduce((d,u)=>new Date(d.check_in_time)<new Date(u.check_in_time)?d:u),i=new Date(o.check_in_time),k=Math.floor((Date.now()-i.getTime())/(60*60*1e3));g({guest:o.guest.name,checkInTime:i,hoursOverdue:k,logId:o.id}),s(!0)}else s(!1)}catch(a){console.error("Failed to fetch overdue guests:",a)}};c();const j=setInterval(c,n*60*1e3);return()=>clearInterval(j)},[n]);const p=()=>{s(!1),setTimeout(()=>s(!0),10*60*1e3)},x=()=>{t!=null&&t.logId&&v.post(route("guest.log.checkout",t.logId),{},{onSuccess:()=>{h({title:"Guest Checked Out",description:`${t.guest} has been successfully checked out.`,color:success}),s(!1)},onError:()=>{h({title:"Checkout Failed",description:"An error occurred while checking out the guest.",color:danger})}})};return e.jsx(b,{isOpen:f,onClose:()=>s(!1),placement:"center",backdrop:"blur",children:e.jsx(O,{children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Overdue Check-out Reminder"}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-4",children:[e.jsx("strong",{children:t.guest})," has not checked out after"," ",e.jsxs("strong",{children:[t.hoursOverdue," hour(s)"]}),"."]}),e.jsxs("p",{children:["Checked in at:"," ",_(t.checkInTime)]})]}),e.jsxs("div",{className:"mt-6 flex justify-center gap-3",children:[e.jsx(m,{color:"primary",onPress:x,children:"Check Out Now"}),e.jsx(m,{variant:"flat",onPress:p,children:"Remind Me Later"})]})]})})})})}export{D as A};
